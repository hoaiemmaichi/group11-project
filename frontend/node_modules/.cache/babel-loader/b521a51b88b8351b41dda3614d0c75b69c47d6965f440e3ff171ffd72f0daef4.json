{"ast":null,"code":"var _jsxFileName = \"d:\\\\group11-project1\\\\group11-project1\\\\frontend\\\\src\\\\Profile.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Modal from './components/Modal';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst API = process.env.REACT_APP_API_URL || 'http://localhost:3000';\nexport default function Profile({\n  token,\n  onUpdated,\n  currentUser,\n  setCurrentUser\n}) {\n  _s();\n  // Cờ tính năng: hiển thị các phần theo yêu cầu. Đặt true để BẬT.\n  const SHOW_AVATAR_FEATURE = true; // Bật lại upload/hiển thị avatar\n  const SHOW_DELETE_ACCOUNT = true; // Bật lại nút \"Xóa tài khoản\"\n  // Cờ hiển thị email ngay dưới tên trong phần tiêu đề hồ sơ\n  const SHOW_EMAIL_UNDER_NAME = false; // Ẩn theo yêu cầu; có thể bật lại bằng cách đặt true\n  // Saved profile data shown in the view\n  const [profileData, setProfileData] = useState({\n    name: (currentUser === null || currentUser === void 0 ? void 0 : currentUser.name) || '',\n    email: (currentUser === null || currentUser === void 0 ? void 0 : currentUser.email) || ''\n  });\n  // Draft data for the edit modal (so Cancel/X discards changes)\n  const [draft, setDraft] = useState({\n    name: '',\n    email: ''\n  });\n  const [avatarUrl, setAvatarUrl] = useState((currentUser === null || currentUser === void 0 ? void 0 : currentUser.avatarUrl) || '');\n  const [uploading, setUploading] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [openEdit, setOpenEdit] = useState(false);\n  const [showSaveConfirm, setShowSaveConfirm] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [showTokenModal, setShowTokenModal] = useState(false);\n  const [copied, setCopied] = useState(false);\n  useEffect(() => {\n    async function fetchProfile() {\n      try {\n        setMessage('');\n        const res = await axios.get(`${API}/profile`, {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        const {\n          name,\n          email,\n          avatarUrl: aurl\n        } = res.data || {};\n        setProfileData({\n          name: name || '',\n          email: email || ''\n        });\n        if (aurl) setAvatarUrl(aurl);\n      } catch (err) {\n        var _err$response, _err$response$data;\n        const serverMsg = ((_err$response = err.response) === null || _err$response === void 0 ? void 0 : (_err$response$data = _err$response.data) === null || _err$response$data === void 0 ? void 0 : _err$response$data.message) || err.message;\n        setMessage(serverMsg || 'Không thể tải hồ sơ');\n      }\n    }\n    if (token) fetchProfile();\n  }, [token]);\n  const handleChange = e => {\n    const {\n      name,\n      value\n    } = e.target;\n    setDraft(prev => ({\n      ...prev,\n      [name]: value\n    }));\n  };\n  const openEditModal = () => {\n    setMessage('');\n    setDraft({\n      name: profileData.name || '',\n      email: profileData.email || ''\n    });\n    setOpenEdit(true);\n  };\n  const closeEditModal = () => {\n    setOpenEdit(false);\n    setDraft({\n      name: '',\n      email: ''\n    }); // discard edits\n    setMessage('');\n  };\n\n  // Thực hiện lưu thông tin (được gọi sau khi xác nhận)\n  const doSave = async () => {\n    const trimmedName = (draft.name || '').trim();\n    const trimmedEmail = (draft.email || '').trim();\n    if (!trimmedName) {\n      setMessage('Tên không được để trống');\n      return;\n    }\n    setLoading(true);\n    setMessage('');\n    try {\n      const res = await axios.put(`${API}/profile`, {\n        name: trimmedName,\n        email: trimmedEmail\n      }, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      const updated = res.data;\n      setProfileData({\n        name: updated.name || trimmedName,\n        email: updated.email || trimmedEmail\n      });\n      if (setCurrentUser) {\n        const mergedUser = {\n          ...(currentUser || {}),\n          ...updated\n        };\n        setCurrentUser(mergedUser);\n        try {\n          localStorage.setItem('currentUser', JSON.stringify(mergedUser));\n        } catch (_) {}\n      }\n      if (onUpdated) onUpdated(updated);\n      setMessage('Cập nhật thành công');\n      setShowSaveConfirm(false);\n      closeEditModal();\n    } catch (err) {\n      var _err$response2, _err$response2$data;\n      const serverMsg = ((_err$response2 = err.response) === null || _err$response2 === void 0 ? void 0 : (_err$response2$data = _err$response2.data) === null || _err$response2$data === void 0 ? void 0 : _err$response2$data.message) || err.message;\n      setMessage(serverMsg || 'Cập nhật thất bại');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Khi submit form, chỉ mở hộp xác nhận (không lưu ngay)\n  const handleSubmit = e => {\n    e.preventDefault();\n    const trimmedName = (draft.name || '').trim();\n    if (!trimmedName) {\n      setMessage('Tên không được để trống');\n      return;\n    }\n    setShowSaveConfirm(true);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      padding: 18\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-header\",\n        children: [SHOW_AVATAR_FEATURE && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-avatar\",\n          style: {\n            width: 56,\n            height: 56,\n            borderRadius: '50%',\n            overflow: 'hidden',\n            marginRight: 10\n          },\n          children: avatarUrl ? /*#__PURE__*/_jsxDEV(\"img\", {\n            src: avatarUrl,\n            alt: \"avatar\",\n            style: {\n              width: '100%',\n              height: '100%',\n              objectFit: 'cover'\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 17\n          }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              width: '100%',\n              height: '100%',\n              display: 'flex',\n              alignItems: 'center',\n              justifyContent: 'center',\n              background: '#e3f2fd',\n              color: '#1565c0',\n              fontWeight: 700\n            },\n            children: profileData.name ? profileData.name[0].toUpperCase() : 'U'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 109,\n            columnNumber: 17\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-summary\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-name\",\n            children: profileData.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 13\n          }, this), SHOW_EMAIL_UNDER_NAME && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-email\",\n            children: profileData.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-actions\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn small\",\n            onClick: openEditModal,\n            children: \"S\\u1EEDa\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn small\",\n            onClick: () => setShowTokenModal(true),\n            children: \"Xem Token\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 13\n          }, this), SHOW_DELETE_ACCOUNT && /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn small danger\",\n            onClick: () => setShowDeleteConfirm(true),\n            children: \"X\\xF3a t\\xE0i kho\\u1EA3n\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profile-details\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-label\",\n            children: \"H\\u1ECD v\\xE0 t\\xEAn\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-value\",\n            children: profileData.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profile-field\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-label\",\n            children: \"Email\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"profile-value\",\n            children: profileData.email\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 135,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: openEdit,\n      title: \"C\\u1EADp nh\\u1EADt th\\xF4ng tin\",\n      onClose: closeEditModal,\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        className: \"user-form\",\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"input\",\n            name: \"name\",\n            placeholder: \"T\\xEAn\",\n            value: draft.name,\n            onChange: handleChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"form-group\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"input\",\n            name: \"email\",\n            type: \"email\",\n            placeholder: \"Email\",\n            value: draft.email,\n            onChange: handleChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            gap: 8,\n            justifyContent: 'flex-end'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"button\",\n            className: \"btn small\",\n            onClick: closeEditModal,\n            children: \"H\\u1EE7y\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 151,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn small\",\n            type: \"submit\",\n            disabled: loading,\n            children: loading ? 'Đang...' : 'Lưu'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 152,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 9\n      }, this), SHOW_AVATAR_FEATURE && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 12\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            fontWeight: 600,\n            marginBottom: 6\n          },\n          children: \"\\u1EA2nh \\u0111\\u1EA1i di\\u1EC7n\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"file\",\n          accept: \"image/*\",\n          onChange: async e => {\n            var _e$target$files;\n            const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n            if (!file) return;\n            setUploading(true);\n            setMessage('');\n            try {\n              const formData = new FormData();\n              formData.append('avatar', file);\n              const res = await fetch(`${API}/upload-avatar`, {\n                method: 'POST',\n                headers: {\n                  'Authorization': `Bearer ${token}`\n                },\n                body: formData\n              });\n              const data = await res.json();\n              if (!res.ok) throw new Error((data === null || data === void 0 ? void 0 : data.message) || 'Upload thất bại');\n              setAvatarUrl(data.avatarUrl);\n              if (setCurrentUser) {\n                const merged = {\n                  ...(currentUser || {}),\n                  avatarUrl: data.avatarUrl\n                };\n                setCurrentUser(merged);\n                try {\n                  localStorage.setItem('currentUser', JSON.stringify(merged));\n                } catch (_) {}\n              }\n              setMessage('Tải ảnh thành công');\n            } catch (err) {\n              setMessage(err.message);\n            } finally {\n              setUploading(false);\n            }\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 13\n        }, this), uploading && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            marginTop: 6\n          },\n          children: \"\\u0110ang t\\u1EA3i \\u1EA3nh...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 27\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 11\n      }, this), message && /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginTop: 8,\n          color: message.includes('thành công') ? '#2e7d32' : '#c62828'\n        },\n        children: message\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: showSaveConfirm,\n      title: \"X\\xE1c nh\\u1EADn\",\n      onClose: () => setShowSaveConfirm(false),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 12\n        },\n        children: \"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n l\\u01B0u thay \\u0111\\u1ED5i th\\xF4ng tin?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 8,\n          justifyContent: 'flex-end'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn small\",\n          onClick: () => setShowSaveConfirm(false),\n          children: \"H\\u1EE7y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn small\",\n          onClick: doSave,\n          disabled: loading,\n          children: loading ? 'Đang lưu...' : 'Lưu'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: showTokenModal,\n      title: \"Token truy c\\u1EADp\",\n      onClose: () => {\n        setShowTokenModal(false);\n        setCopied(false);\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 12,\n          wordBreak: 'break-all'\n        },\n        children: token ? token : 'Không tìm thấy token. Vui lòng đăng nhập để xem token.'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 8,\n          justifyContent: 'flex-end',\n          alignItems: 'center'\n        },\n        children: [copied && /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: '#2e7d32'\n          },\n          children: \"\\u0110\\xE3 sao ch\\xE9p\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 22\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn small\",\n          onClick: () => {\n            setShowTokenModal(false);\n            setCopied(false);\n          },\n          children: \"\\u0110\\xF3ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn small\",\n          onClick: async () => {\n            if (!token) return;\n            try {\n              if (navigator && navigator.clipboard && navigator.clipboard.writeText) {\n                await navigator.clipboard.writeText(token);\n              } else {\n                const ta = document.createElement('textarea');\n                ta.value = token;\n                document.body.appendChild(ta);\n                ta.select();\n                document.execCommand('copy');\n                document.body.removeChild(ta);\n              }\n              setCopied(true);\n              setTimeout(() => setCopied(false), 2000);\n            } catch (e) {\n              alert('Không thể sao chép token');\n            }\n          },\n          children: \"Sao ch\\xE9p\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 207,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      open: showDeleteConfirm,\n      title: \"X\\xE1c nh\\u1EADn\",\n      onClose: () => setShowDeleteConfirm(false),\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: 12\n        },\n        children: \"B\\u1EA1n c\\xF3 ch\\u1EAFc ch\\u1EAFn mu\\u1ED1n x\\xF3a t\\xE0i kho\\u1EA3n? H\\xE0nh \\u0111\\u1ED9ng n\\xE0y kh\\xF4ng th\\u1EC3 ho\\xE0n t\\xE1c.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          gap: 8,\n          justifyContent: 'flex-end'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn small\",\n          onClick: () => setShowDeleteConfirm(false),\n          children: \"H\\u1EE7y\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn small danger\",\n          onClick: async () => {\n            try {\n              await axios.delete(`${API}/users/${(currentUser === null || currentUser === void 0 ? void 0 : currentUser.id) || (currentUser === null || currentUser === void 0 ? void 0 : currentUser._id)}`, {\n                headers: {\n                  Authorization: `Bearer ${token}`\n                }\n              });\n              setShowDeleteConfirm(false);\n              // Đăng xuất sau khi xóa chính mình\n              localStorage.removeItem('token');\n              localStorage.removeItem('currentUser');\n              window.location.reload();\n            } catch (err) {\n              var _err$response3, _err$response3$data;\n              setShowDeleteConfirm(false);\n              alert(((_err$response3 = err.response) === null || _err$response3 === void 0 ? void 0 : (_err$response3$data = _err$response3.data) === null || _err$response3$data === void 0 ? void 0 : _err$response3$data.message) || 'Xóa tài khoản thất bại');\n            }\n          },\n          children: \"X\\xF3a\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 5\n  }, this);\n}\n_s(Profile, \"6YmWGMTgo4CQ6VTEJ2GmsrFN6XE=\");\n_c = Profile;\nvar _c;\n$RefreshReg$(_c, \"Profile\");","map":{"version":3,"names":["React","useEffect","useState","axios","Modal","jsxDEV","_jsxDEV","API","process","env","REACT_APP_API_URL","Profile","token","onUpdated","currentUser","setCurrentUser","_s","SHOW_AVATAR_FEATURE","SHOW_DELETE_ACCOUNT","SHOW_EMAIL_UNDER_NAME","profileData","setProfileData","name","email","draft","setDraft","avatarUrl","setAvatarUrl","uploading","setUploading","loading","setLoading","message","setMessage","openEdit","setOpenEdit","showSaveConfirm","setShowSaveConfirm","showDeleteConfirm","setShowDeleteConfirm","showTokenModal","setShowTokenModal","copied","setCopied","fetchProfile","res","get","headers","Authorization","aurl","data","err","_err$response","_err$response$data","serverMsg","response","handleChange","e","value","target","prev","openEditModal","closeEditModal","doSave","trimmedName","trim","trimmedEmail","put","updated","mergedUser","localStorage","setItem","JSON","stringify","_","_err$response2","_err$response2$data","handleSubmit","preventDefault","style","padding","children","className","width","height","borderRadius","overflow","marginRight","src","alt","objectFit","fileName","_jsxFileName","lineNumber","columnNumber","display","alignItems","justifyContent","background","color","fontWeight","toUpperCase","onClick","open","title","onClose","onSubmit","placeholder","onChange","required","type","gap","disabled","marginTop","marginBottom","accept","_e$target$files","file","files","formData","FormData","append","fetch","method","body","json","ok","Error","merged","includes","wordBreak","navigator","clipboard","writeText","ta","document","createElement","appendChild","select","execCommand","removeChild","setTimeout","alert","delete","id","_id","removeItem","window","location","reload","_err$response3","_err$response3$data","_c","$RefreshReg$"],"sources":["d:/group11-project1/group11-project1/frontend/src/Profile.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport axios from 'axios';\nimport Modal from './components/Modal';\n\nconst API = process.env.REACT_APP_API_URL || 'http://localhost:3000';\n\nexport default function Profile({ token, onUpdated, currentUser, setCurrentUser }) {\n  // Cờ tính năng: hiển thị các phần theo yêu cầu. Đặt true để BẬT.\n  const SHOW_AVATAR_FEATURE = true; // Bật lại upload/hiển thị avatar\n  const SHOW_DELETE_ACCOUNT = true; // Bật lại nút \"Xóa tài khoản\"\n  // Cờ hiển thị email ngay dưới tên trong phần tiêu đề hồ sơ\n  const SHOW_EMAIL_UNDER_NAME = false; // Ẩn theo yêu cầu; có thể bật lại bằng cách đặt true\n  // Saved profile data shown in the view\n  const [profileData, setProfileData] = useState({ name: currentUser?.name || '', email: currentUser?.email || '' });\n  // Draft data for the edit modal (so Cancel/X discards changes)\n  const [draft, setDraft] = useState({ name: '', email: '' });\n  const [avatarUrl, setAvatarUrl] = useState(currentUser?.avatarUrl || '');\n  const [uploading, setUploading] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [message, setMessage] = useState('');\n  const [openEdit, setOpenEdit] = useState(false);\n  const [showSaveConfirm, setShowSaveConfirm] = useState(false);\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);\n  const [showTokenModal, setShowTokenModal] = useState(false);\n  const [copied, setCopied] = useState(false);\n\n  useEffect(() => {\n    async function fetchProfile() {\n      try {\n        setMessage('');\n        const res = await axios.get(`${API}/profile`, {\n          headers: { Authorization: `Bearer ${token}` }\n        });\n        const { name, email, avatarUrl: aurl } = res.data || {};\n        setProfileData({ name: name || '', email: email || '' });\n        if (aurl) setAvatarUrl(aurl);\n      } catch (err) {\n        const serverMsg = err.response?.data?.message || err.message;\n        setMessage(serverMsg || 'Không thể tải hồ sơ');\n      }\n    }\n    if (token) fetchProfile();\n  }, [token]);\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setDraft(prev => ({ ...prev, [name]: value }));\n  };\n\n  const openEditModal = () => {\n    setMessage('');\n    setDraft({ name: profileData.name || '', email: profileData.email || '' });\n    setOpenEdit(true);\n  };\n\n  const closeEditModal = () => {\n    setOpenEdit(false);\n    setDraft({ name: '', email: '' }); // discard edits\n    setMessage('');\n  };\n\n  // Thực hiện lưu thông tin (được gọi sau khi xác nhận)\n  const doSave = async () => {\n    const trimmedName = (draft.name || '').trim();\n    const trimmedEmail = (draft.email || '').trim();\n    if (!trimmedName) { setMessage('Tên không được để trống'); return; }\n    setLoading(true);\n    setMessage('');\n    try {\n      const res = await axios.put(`${API}/profile`, { name: trimmedName, email: trimmedEmail }, {\n        headers: { Authorization: `Bearer ${token}` }\n      });\n      const updated = res.data;\n      setProfileData({ name: updated.name || trimmedName, email: updated.email || trimmedEmail });\n      if (setCurrentUser) {\n        const mergedUser = { ...(currentUser || {}), ...updated };\n        setCurrentUser(mergedUser);\n        try { localStorage.setItem('currentUser', JSON.stringify(mergedUser)); } catch (_) {}\n      }\n      if (onUpdated) onUpdated(updated);\n      setMessage('Cập nhật thành công');\n      setShowSaveConfirm(false);\n      closeEditModal();\n    } catch (err) {\n      const serverMsg = err.response?.data?.message || err.message;\n      setMessage(serverMsg || 'Cập nhật thất bại');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Khi submit form, chỉ mở hộp xác nhận (không lưu ngay)\n  const handleSubmit = (e) => {\n    e.preventDefault();\n    const trimmedName = (draft.name || '').trim();\n    if (!trimmedName) { setMessage('Tên không được để trống'); return; }\n    setShowSaveConfirm(true);\n  };\n\n  return (\n    <div style={{padding:18}}>\n      <div className=\"profile-card\">\n        <div className=\"profile-header\">\n          {SHOW_AVATAR_FEATURE && (\n            <div className=\"profile-avatar\" style={{width:56,height:56,borderRadius:'50%',overflow:'hidden',marginRight:10}}>\n              {avatarUrl ? (\n                <img src={avatarUrl} alt=\"avatar\" style={{width:'100%',height:'100%',objectFit:'cover'}} />\n              ) : (\n                <div style={{width:'100%',height:'100%',display:'flex',alignItems:'center',justifyContent:'center',background:'#e3f2fd',color:'#1565c0',fontWeight:700}}>\n                  {profileData.name ? profileData.name[0].toUpperCase() : 'U'}\n                </div>\n              )}\n            </div>\n          )}\n          <div className=\"profile-summary\">\n            <div className=\"profile-name\">{profileData.name}</div>\n            {SHOW_EMAIL_UNDER_NAME && (\n              <div className=\"profile-email\">{profileData.email}</div>\n            )}\n          </div>\n          <div className=\"profile-actions\">\n            <button className=\"btn small\" onClick={openEditModal}>Sửa</button>\n            <button className=\"btn small\" onClick={() => setShowTokenModal(true)}>Xem Token</button>\n            {SHOW_DELETE_ACCOUNT && (\n              <button className=\"btn small danger\" onClick={() => setShowDeleteConfirm(true)}>Xóa tài khoản</button>\n            )}\n          </div>\n        </div>\n\n        <div className=\"profile-details\">\n          <div className=\"profile-field\">\n            <div className=\"profile-label\">Họ và tên</div>\n            <div className=\"profile-value\">{profileData.name}</div>\n          </div>\n          <div className=\"profile-field\">\n            <div className=\"profile-label\">Email</div>\n            <div className=\"profile-value\">{profileData.email}</div>\n          </div>\n        </div>\n      </div>\n\n      <Modal open={openEdit} title=\"Cập nhật thông tin\" onClose={closeEditModal}>\n        <form className=\"user-form\" onSubmit={handleSubmit}>\n          <div className=\"form-group\">\n            <input className=\"input\" name=\"name\" placeholder=\"Tên\" value={draft.name} onChange={handleChange} required />\n          </div>\n          <div className=\"form-group\">\n            <input className=\"input\" name=\"email\" type=\"email\" placeholder=\"Email\" value={draft.email} onChange={handleChange} required />\n          </div>\n          <div style={{display:'flex',gap:8,justifyContent:'flex-end'}}>\n            <button type=\"button\" className=\"btn small\" onClick={closeEditModal}>Hủy</button>\n            <button className=\"btn small\" type=\"submit\" disabled={loading}>{loading ? 'Đang...' : 'Lưu'}</button>\n          </div>\n        </form>\n        {SHOW_AVATAR_FEATURE && (\n          <div style={{marginTop:12}}>\n            <div style={{fontWeight:600, marginBottom:6}}>Ảnh đại diện</div>\n            <input type=\"file\" accept=\"image/*\" onChange={async (e) => {\n              const file = e.target.files?.[0];\n              if (!file) return;\n              setUploading(true);\n              setMessage('');\n              try {\n                const formData = new FormData();\n                formData.append('avatar', file);\n                const res = await fetch(`${API}/upload-avatar`, {\n                  method: 'POST',\n                  headers: { 'Authorization': `Bearer ${token}` },\n                  body: formData\n                });\n                const data = await res.json();\n                if (!res.ok) throw new Error(data?.message || 'Upload thất bại');\n                setAvatarUrl(data.avatarUrl);\n                if (setCurrentUser) {\n                  const merged = { ...(currentUser||{}), avatarUrl: data.avatarUrl };\n                  setCurrentUser(merged);\n                  try { localStorage.setItem('currentUser', JSON.stringify(merged)); } catch(_){}\n                }\n                setMessage('Tải ảnh thành công');\n              } catch (err) {\n                setMessage(err.message);\n              } finally { setUploading(false); }\n            }} />\n            {uploading && <div style={{marginTop:6}}>Đang tải ảnh...</div>}\n          </div>\n        )}\n        {message && <div style={{marginTop:8,color: message.includes('thành công') ? '#2e7d32' : '#c62828'}}>{message}</div>}\n      </Modal>\n\n        {/* Hộp xác nhận lưu thay đổi */}\n        <Modal open={showSaveConfirm} title=\"Xác nhận\" onClose={() => setShowSaveConfirm(false)}>\n          <div style={{marginBottom:12}}>Bạn có chắc chắn muốn lưu thay đổi thông tin?</div>\n          <div style={{display:'flex',gap:8,justifyContent:'flex-end'}}>\n            <button className=\"btn small\" onClick={() => setShowSaveConfirm(false)}>Hủy</button>\n            <button className=\"btn small\" onClick={doSave} disabled={loading}>{loading ? 'Đang lưu...' : 'Lưu'}</button>\n          </div>\n        </Modal>\n\n      {/* Hộp hiển thị token truy cập */}\n      <Modal open={showTokenModal} title=\"Token truy cập\" onClose={() => { setShowTokenModal(false); setCopied(false); }}>\n        <div style={{marginBottom:12, wordBreak:'break-all'}}>\n          {token ? token : 'Không tìm thấy token. Vui lòng đăng nhập để xem token.'}\n        </div>\n        <div style={{display:'flex',gap:8,justifyContent:'flex-end', alignItems:'center'}}>\n          {copied && <div style={{color:'#2e7d32'}}>Đã sao chép</div>}\n          <button className=\"btn small\" onClick={() => { setShowTokenModal(false); setCopied(false); }}>Đóng</button>\n          <button className=\"btn small\" onClick={async () => {\n            if (!token) return;\n            try {\n              if (navigator && navigator.clipboard && navigator.clipboard.writeText) {\n                await navigator.clipboard.writeText(token);\n              } else {\n                const ta = document.createElement('textarea');\n                ta.value = token;\n                document.body.appendChild(ta);\n                ta.select();\n                document.execCommand('copy');\n                document.body.removeChild(ta);\n              }\n              setCopied(true);\n              setTimeout(() => setCopied(false), 2000);\n            } catch (e) {\n              alert('Không thể sao chép token');\n            }\n          }}>Sao chép</button>\n        </div>\n      </Modal>\n\n        {/* Hộp xác nhận xóa tài khoản */}\n        <Modal open={showDeleteConfirm} title=\"Xác nhận\" onClose={() => setShowDeleteConfirm(false)}>\n          <div style={{marginBottom:12}}>Bạn có chắc chắn muốn xóa tài khoản? Hành động này không thể hoàn tác.</div>\n          <div style={{display:'flex',gap:8,justifyContent:'flex-end'}}>\n            <button className=\"btn small\" onClick={() => setShowDeleteConfirm(false)}>Hủy</button>\n            <button\n              className=\"btn small danger\"\n              onClick={async () => {\n                try {\n                  await axios.delete(`${API}/users/${currentUser?.id || currentUser?._id}`, { headers: { Authorization: `Bearer ${token}` }});\n                  setShowDeleteConfirm(false);\n                  // Đăng xuất sau khi xóa chính mình\n                  localStorage.removeItem('token');\n                  localStorage.removeItem('currentUser');\n                  window.location.reload();\n                } catch (err) {\n                  setShowDeleteConfirm(false);\n                  alert(err.response?.data?.message || 'Xóa tài khoản thất bại');\n                }\n              }}\n            >\n              Xóa\n            </button>\n          </div>\n        </Modal>\n    </div>\n  );\n}\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}